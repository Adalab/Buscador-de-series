"use strict";let movies=[],favorites=[];const inputElement=document.querySelector(".js-input"),moviesContainer=document.querySelector(".js-results-list"),placeholderImg="//via.placeholder.com/210x295/ffffff/666666/?text=Imagen no encontrada",formElement=document.querySelector(".js-form");function getDataFromApi(){const e=inputElement.value;fetch("//api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{movies=[];for(let t=0;t<e.length;t++){const i=e[t].show;movies.push(i)}paintMovies(),setInLocalStorage()})}function handleForm(e){e.preventDefault(),getDataFromApi()}function paintMovies(){let e="";for(const t of movies){let i="";i=isFavoriteMovie(t)?"show-background":"",e+=`<li  class="serie__list js-movie ${i}"id="${t.id}">`,e+='<div class="">',null!==t.image?e+=`<img class="serie__image" src="${t.image.medium}" alt="img"/>`:e+=`<img class="serie__image" src="${placeholderImg}" alt="img"/>`,e+="</div>";for(const t of movies)e+=`<div class="movie__color"style="background-color: #${t}"></div>`;e+=`<h3 class="serie__name">${t.name}</h3>`,e+="</li>"}moviesContainer.innerHTML=e,listenMovieEvents()}function listenMovieEvents(){const e=document.querySelectorAll(".js-movie");for(const t of e)t.addEventListener("click",handleMovie)}function isFavoriteMovie(e){return void 0!==favorites.find(t=>t.id===e.id)}function handleMovie(e){const t=parseInt(e.currentTarget.id),i=favorites.findIndex((function(e){return e.id===t}));if(-1===i){const e=movies.find((function(e){return e.id===t}));favorites.push(e)}else favorites.splice(i,1);paintMovies(),paintFavorites()}function paintFavorites(){let e="";for(const t of favorites){e+=`<li class="js-fav" id="${t.id}">`,e+=`<h2 class="js-favTitle"${t.name}</h2>`;const i=t.image;e+=null===i?`<img class="sectionFav__list--img" src="${placeholderImg}">`:`<img class="sectionFav__list--img" src="${i.medium}">`,e+="</li>"}document.querySelector(".js-fav-list").innerHTML=e}function setInLocalStorage(){const e=JSON.stringify(favorites);localStorage.setItem("favorites",e)}function getFromLocalStorage(){const e=localStorage.getItem("favorites");if(null===e)getDataFromApi();else{const t=JSON.parse(e);favorites=t,paintFavorites()}}formElement.addEventListener("submit",handleForm),getFromLocalStorage();